@using CarAdmin.Controllers.Extensions
@using CarAdmin.Models
@{
    ViewBag.Title = "表信息";
    Layout = "~/Views/_Layout.cshtml";


    var pager = new PagerInfo()
    {
        CurrentPageIndex = ViewBag.PageIndex ?? 1,
        TotalCount = ViewBag.Count ?? 0,
        PageSize = ViewBag.PageSize ?? 20
    };
}

<!--main content start-->
<section id="main-content" ng-controller="ngCtrl">
    <section class="wrapper">
        <div class="table-agile-info">
            <div class="panel panel-default">
                <div class="panel-heading">
                    国家
                </div>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th width="5%">CountryID</th>
                                <th width="15%">名称</th>
                                <th width="5%">编码</th>
                                <th width="15%">别名</th>
                                <th width="40%">LogoUrl</th>
                                <th width="10%">区域</th>
                                <th width="10%">操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="x in countrys">
                                <td>{{ x.CountryID }}</td>
                                <td>{{ x.Name }}</td>
                                <td>{{ x.Code }}</td>
                                <td>{{ x.OtherName }}</td>
                                <td>{{ x.LogoUrl }}</td>
                                <td>{{ x.Area }}</td>
                                <td>
                                    <a class="btn btn-success" data-toggle="modal" data-whatever="{{x.CountryID}}" href="#myModal">编辑</a>|
                                    <a class="btn btn-success">删除</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <ul class="pagination">
                        @Html.PageHelper(pager)
                    </ul>

                </div>
            </div>
        </div>
    </section>
    <!-- footer -->
    @Html.Partial("../Shared/_footer")
    <!-- / footer -->

    <div tabindex="-1" id="myModal" class="modal fade in">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                    <h4 class="modal-title">修改</h4>
                </div>
                <div class="modal-body">
                    <form role="form">
                        <div class="form-group">
                            <label>名称</label>
                            <input type="text" ng-model="Name" class="form-control" placeholder="名称">
                        </div>
                        <div class="form-group">
                            <label>编码</label>
                            <input type="text" ng-model="Code" class="form-control" placeholder="编码">
                        </div>
                        <div class="form-group">
                            <label>别名</label>
                            <input type="text" ng-model="OtherName" class="form-control" placeholder="别名">
                        </div>
                        <div class="form-group">
                            <label>LogoUrl</label>
                            <input type="text" ng-model="LogoUrl" class="form-control" placeholder="LogoUrl">
                        </div>
                        <div class="form-group">
                            <label>区域</label>
                            <input type="text" ng-model="Area" class="form-control" placeholder="区域">
                        </div>
                        <button type="submit" class="btn btn-default">保存</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
<!--main content end-->

@section head_scripts{
    <script>
        var app = angular.module('ngApp', []);

        app.controller('ngCtrl', function($scope) {
            $scope.countrys = @Html.Raw(ViewBag.Tab);

            $scope.editCountry = function(cId) {
                debugger
                // 执行一些动作...
            };
        });
       
    </script>
}
<script type="text/javascript">
    $('#myModal').on('show.bs.modal', function(e) {
        debugger

        $.ajax({
            url: '/DataTables/GetCountriesAll',
            type: 'get',
            data: { Id: e.isTrigger },
            success: function(dt) {
                if (dt == null || dt == 'undefined')
                    return;
                var obj = eval('(' + dt + ')')[0];
                $scope.Name = obj.Name;
                $scope.Code = obj.Code;
                $scope.OtherName = obj.OtherName;
                $scope.LogoUrl = obj.LogoUrl;
                $scope.Area = obj.Area;
                debugger
            }
        });
        var button = $(e.relatedTarget) // 触发事件的按钮
        var recipient = button.data('whatever') // 解析出data-whatever内容
        var modal = $(this)
        modal.find('.modal-title').text('Message To ' + recipient)
        modal.find('.modal-body input').val(recipient)
    });
</script>